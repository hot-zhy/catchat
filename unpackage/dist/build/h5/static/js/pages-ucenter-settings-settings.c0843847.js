(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-ucenter-settings-settings"],{"1cdd":function(e,t,n){var i=n("e22a");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var o=n("4f06").default;o("3383599b",i,!0,{sourceMap:!1,shadowMode:!1})},3120:function(e,t,n){"use strict";n.r(t);var i=n("fb7d"),o=n("46d1");for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("5c8c");var s=n("f0c5"),r=Object(s["a"])(o["default"],i["b"],i["c"],!1,null,"3b2a7b06",null,!1,i["a"],void 0);t["default"]=r.exports},"46d1":function(e,t,n){"use strict";n.r(t);var i=n("b905"),o=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(a);t["default"]=o.a},"5c8c":function(e,t,n){"use strict";var i=n("1cdd"),o=n.n(i);o.a},"5fc5":function(e,t,n){"use strict";function i(){var e=void 0;try{if("iOS"==plus.os.name){var t=0,n=plus.ios.invoke("UIApplication","sharedApplication"),i=plus.ios.invoke(n,"currentUserNotificationSettings");i?(t=i.plusGetAttribute("types"),plus.ios.deleteObject(i)):t=plus.ios.invoke(n,"enabledRemoteNotificationTypes"),plus.ios.deleteObject(n),e=0!=t}else{var o=plus.android.runtimeMainActivity(),a=plus.android.invoke("com.igexin.sdk.PushManager","getInstance");e=plus.android.invoke(a,"isPushTurnedOn",o)}}catch(s){console.error("exception in isTurnedOnPush@dc-push!!")}return e}function o(){try{if("iOS"==plus.os.name){var e=plus.ios.invoke("UIApplication","sharedApplication"),t=plus.ios.invoke("NSURL","URLWithString:","app-settings:");plus.ios.invoke(e,"openURL:",t),plus.ios.deleteObject(t),plus.ios.deleteObject(e)}}catch(n){console.error("exception in settingInIos@dc-push!!")}}n("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a={isOn:i,iosSetting:o,on:function(){try{if("iOS"==plus.os.name)i()||o();else{var e=plus.android.runtimeMainActivity(),t=plus.android.invoke("com.igexin.sdk.PushManager","getInstance");plus.android.invoke(t,"turnOnPush",e)}}catch(n){console.error("exception in turnOnPush@dc-push!!")}},off:function(){try{if("iOS"==plus.os.name);else{var e=plus.android.runtimeMainActivity(),t=plus.android.invoke("com.igexin.sdk.PushManager","getInstance");plus.android.invoke(t,"turnOffPush",e)}}catch(n){console.error("exception in trunOffPush@dc-push!!")}},setting:function(){"ios"==uni.getSystemInfoSync().platform&&o(),"android"==uni.getSystemInfoSync().platform&&function(){if("android"==uni.getSystemInfoSync().platform){var e=plus.android.runtimeMainActivity(),t=plus.android.importClass("android.content.Intent"),n=plus.android.importClass("android.provider.Settings"),i=new t(n.ACTION_APPLICATION_DETAILS_SETTINGS);e.startActivity(i)}}()}};t.default=a},a220:function(e,t,n){"use strict";(function(e){n("7a82");var i=n("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.store=t.mutations=void 0;var o=i(n("c7eb")),a=i(n("1da1"));n("b64b"),n("d3b7"),n("159b"),n("99af");var s=i(n("6783")),r=i(n("8bf3")),u=i(n("e143")),c=e.importObject("uni-id-co"),l=e.database(),d=l.collection("uni-id-users"),f=uni.getStorageSync("uni-id-pages-userInfo")||{},g={userInfo:f,hasLogin:0!=Object.keys(f).length},p={updateUserInfo:function(){var e=arguments,t=this;return(0,a.default)((0,o.default)().mark((function n(){var i,a;return(0,o.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=e.length>0&&void 0!==e[0]&&e[0],console.log(20,i),!i){n.next=6;break}d.where("_id==$env.uid").update(i).then((function(e){e.result.updated?(uni.showToast({title:"更新成功",icon:"none",duration:3e3}),t.setUserInfo(i)):uni.showToast({title:"没有改变",icon:"none",duration:3e3})})),n.next=17;break;case 6:return n.prev=6,n.next=9,d.where("'_id' == $cloudEnv_uid").field("mobile,nickname,username,email,avatar_file").get();case 9:a=n.sent,t.setUserInfo(a.result.data[0]),n.next=17;break;case 13:n.prev=13,n.t0=n["catch"](6),t.setUserInfo({},{cover:!0}),console.error(n.t0.message,n.t0.errCode);case 17:case"end":return n.stop()}}),n,null,[[6,13]])})))()},setUserInfo:function(e){var t=arguments;return(0,a.default)((0,o.default)().mark((function n(){var i,a,s;return(0,o.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=t.length>1&&void 0!==t[1]?t[1]:{cover:!1},a=i.cover,console.log("set-userInfo",e),s=a?e:Object.assign(h.userInfo,e),h.userInfo=Object.assign({},s),h.hasLogin=0!=Object.keys(h.userInfo).length,console.log("store.userInfo",h.userInfo),uni.setStorage({key:"uni-id-pages-userInfo",data:h.userInfo}),n.abrupt("return",e);case 8:case"end":return n.stop()}}),n)})))()},logout:function(){var t=this;return(0,a.default)((0,o.default)().mark((function n(){var i,a;return(0,o.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!(e.getCurrentUserInfo().tokenExpired>Date.now())){n.next=9;break}return n.prev=1,n.next=4,c.logout();case 4:n.next=9;break;case 6:n.prev=6,n.t0=n["catch"](1),console.error(n.t0);case 9:uni.removeStorageSync("uni_id_token"),uni.setStorageSync("uni_id_token_expired",0),uni.redirectTo({url:"/".concat(null!==(i=null===(a=s.default.uniIdRouter)||void 0===a?void 0:a.loginPage)&&void 0!==i?i:"uni_modules/uni-id-pages/pages/login/login-withoutpwd")}),uni.$emit("uni-id-pages-logout"),t.setUserInfo({},{cover:!0});case 14:case"end":return n.stop()}}),n,null,[[1,6]])})))()},loginBack:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.uniIdRedirectUrl,n=void 0===t?"":t,i=0,o=getCurrentPages();if(o.forEach((function(e,t){"login"==o[o.length-t-1].route.split("/")[3]&&i++})),n)return uni.reLaunch({url:n});if("weixin"==e.loginType)return window.history.go(-3);if(i){var a=s.default.pages[0];return uni.reLaunch({url:"/".concat(a.path)})}uni.navigateBack({delta:i})},loginSuccess:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.showToast,n=void 0===t||t,i=e.toastText,o=void 0===i?"登录成功":i,a=e.autoBack,s=void 0===a||a,u=e.uniIdRedirectUrl,c=void 0===u?"":u,l=e.passwordConfirmed;if(n&&uni.showToast({title:o,icon:"none",duration:3e3}),this.updateUserInfo(),uni.$emit("uni-id-pages-login-success"),r.default.setPasswordAfterLogin&&!l)return uni.redirectTo({url:c?"/uni_modules/uni-id-pages/pages/userinfo/set-pwd/set-pwd?uniIdRedirectUrl=".concat(c,"&loginType=").concat(e.loginType):"/uni_modules/uni-id-pages/pages/userinfo/set-pwd/set-pwd?loginType=".concat(e.loginType),fail:function(e){console.log(e)}});s&&this.loginBack(c)}};t.mutations=p;var h=u.default.observable(g);t.store=h}).call(this,n("a9ff")["default"])},b905:function(e,t,n){"use strict";n("7a82");var i=n("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("d3b7");var o=i(n("c7eb")),a=i(n("1da1")),s=i(n("5fc5")),r=n("a220"),u={data:function(){return{pushServer:s.default,supportMode:[],pushIsOn:"wait",currentLanguage:"",userInfo:{}}},computed:{hasLogin:function(){return r.store.hasLogin},i18nEnable:function(){return getApp().globalData.config.i18n.enable}},onLoad:function(){this.currentLanguage="en"==uni.getStorageSync("CURRENT_LANG")?"English":"简体中文",uni.setNavigationBarTitle({title:this.$t("settings.navigationBarTitle")})},onShow:function(){},methods:{changeLoginState:function(){var e=this;return(0,a.default)((0,o.default)().mark((function t(){return(0,o.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.hasLogin){t.next=5;break}return t.next=3,r.mutations.logout();case 3:t.next=6;break;case 5:uni.redirectTo({url:"/uni_modules/uni-id-pages/pages/login/login-withoutpwd"});case 6:case"end":return t.stop()}}),t)})))()},startSoterAuthentication:function(e){var t=this;console.log(e);var n={fingerPrint:this.$t("settings.fingerPrint"),facial:this.$t("settings.facial")}[e];this.checkIsSoterEnrolledInDevice({checkAuthMode:e,title:n}).then((function(){console.log(e,n),uni.startSoterAuthentication({requestAuthModes:[e],challenge:"123456",authContent:t.$t("settings.please")+" "+"".concat(n),complete:function(e){console.log(e)},success:function(e){if(console.log(e),0==e.errCode)return uni.showToast({title:"".concat(n)+t.$t("settings.successText"),icon:"none"});uni.showToast({title:t.$t("settings.failTip"),icon:"none"})},fail:function(e){console.log(e),console.log("认证失败:".concat(e.errCode)),uni.showToast({title:t.$t("settings.authFailed"),icon:"none"})}})}))},checkIsSoterEnrolledInDevice:function(e){var t=this,n=e.checkAuthMode,i=e.title;return new Promise((function(e,o){uni.checkIsSoterEnrolledInDevice({checkAuthMode:n,success:function(n){if(console.log(n),n.isEnrolled)return e(n);uni.showToast({title:t.$t("settings.deviceNoOpen")+"".concat(i),icon:"none"}),o(n)},fail:function(e){console.log(e),uni.showToast({title:"".concat(i)+t.$t("settings.fail"),icon:"none"}),o(e)}})}))},clearTmp:function(){var e=this;uni.showLoading({title:this.$t("settings.clearing"),mask:!0}),uni.getSavedFileList({success:function(t){t.fileList.length>0?uni.removeSavedFile({filePath:t.fileList[0].filePath,complete:function(t){console.log(t),uni.hideLoading(),uni.showToast({title:e.$t("settings.clearedSuccessed"),icon:"none"})}}):(uni.hideLoading(),uni.showToast({title:e.$t("settings.clearedSuccessed"),icon:"none"}))},complete:function(e){console.log(e)}})},changeLanguage:function(){var e=this;console.log("语言切换"),uni.showActionSheet({itemList:["English","简体中文"],success:function(t){console.log(t.tapIndex);var n=uni.getStorageSync("CURRENT_LANG");if(!t.tapIndex&&"zh-Hans"==n||t.tapIndex&&"en"==n){var i=getApp().globalData;n=i.locale="en"===n?"zh-Hans":"en",uni.setStorageSync("CURRENT_LANG",n),getApp().globalData.$i18n.locale=n,e.currentLanguage=t.tapIndex?"简体中文":"English",uni.setLocale&&uni.setLocale(n),uni.reLaunch({url:"/pages/list/list",complete:function(){uni.$emit("changeLanguage",n)}})}},fail:function(){},complete:function(){}})}}};t.default=u},e22a:function(e,t,n){var i=n("24fb");t=i(!1),t.push([e.i,"\nuni-page-body[data-v-3b2a7b06]{flex:1;width:100%;height:100%}uni-button[data-v-3b2a7b06]:after{border:none;border-radius:0}\n.content[data-v-3b2a7b06]{\ndisplay:flex;width:%?750?%;height:100vh;\nflex-direction:column;flex:1;background-color:#f9f9f9}.bottom-back[data-v-3b2a7b06]{margin-top:10px;width:%?750?%;height:44px;\ndisplay:flex;\nflex-direction:column;justify-content:center;align-items:center;\nborder:none;\nborder-width:0;border-radius:0;background-color:#fff}.bottom-back-text[data-v-3b2a7b06]{font-size:%?33?%}.mt10[data-v-3b2a7b06]{margin-top:10px}\n.content[data-v-3b2a7b06]  .uni-list{background-color:#f9f9f9}.content[data-v-3b2a7b06]  .uni-list-item--disabled,.list-item[data-v-3b2a7b06]{height:50px;margin-bottom:1px}\n",""]),e.exports=t},fb7d:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}));var i={uniList:n("0e4e").default,uniListItem:n("4510").default},o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"content"},[n("uni-list",{staticClass:"mt10",attrs:{border:!1}},[n("uni-list-item",{attrs:{title:e.$t("settings.userInfo"),to:"/uni_modules/uni-id-pages/pages/userinfo/userinfo",link:"navigateTo"}}),e.userInfo.mobile?n("uni-list-item",{attrs:{title:e.$t("settings.changePassword"),to:"/pages/ucenter/login-page/pwd-retrieve/pwd-retrieve?phoneNumber="+e.userInfo.mobile,link:"navigateTo"}}):e._e()],1),n("uni-list",{staticClass:"mt10",attrs:{border:!1}},[e.i18nEnable?n("uni-list-item",{attrs:{title:e.$t("settings.changeLanguage"),rightText:e.currentLanguage,link:!0},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.changeLanguage.apply(void 0,arguments)}}}):e._e()],1),n("v-uni-view",{staticClass:"bottom-back",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.changeLoginState.apply(void 0,arguments)}}},[e.hasLogin?n("v-uni-text",{staticClass:"bottom-back-text"},[e._v(e._s(e.$t("settings.logOut")))]):n("v-uni-text",{staticClass:"bottom-back-text"},[e._v(e._s(e.$t("settings.login")))])],1)],1)},a=[]}}]);